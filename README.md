# Spider Gait Generation Project/Coursework

This project uses genetic algorithms and neural networks to generate walking gaits for an 8-legged spider robot. It compares two neural network implementations: a custom implementation from scratch and PyTorch.

## Requirements

```bash
# Core dependencies
numpy
matplotlib
torch
```

## Installation

1. Clone the repository:
```bash
git clone https://github.com/AICourseworkGroup/Spider.git
cd Spider
```

2. Choose your installation method:

   **Option A - Using Conda (recommended):**
   ```bash
   conda env create -f environment.yml
   conda activate spider
   ```
   *Note: Edit `environment.yml` to uncomment GPU-specific PyTorch versions if you have NVIDIA GPU.*

   **Option B - Using pip with venv:**
   ```bash
   python3 -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   pip install -r requirements.txt
   ```
   *Note: Edit `requirements.txt` to uncomment GPU-specific PyTorch versions if you have NVIDIA/AMD/Intel GPU.*

## Project Structure

## Main.py
Main program that runs both the genetic algorithm and neural networks (self and PyTorch), It will first have the inputs for both chromosomes as variables. The parameters for the chromosomes are the two poses of the spider (standing and mid-gait pose). It will convert these parameters into radians from the math library. 

### createTargetChromosomeList
Upon setting the poses, we will progress to running the createTargetChromosomeList function, which takes in the two poses as parameters and returns a variable called GATargetPoses. This variable also displays/plots the two poses, A and B.

### display_generating_input_data(GATargetPoses)
progressing further into the main program we run a helper function called display_generating_input_data(GATargetPoses) this function prints out step 2 that animates the target chromosomes. after displaying text it will ask the user if they want to animate the target chromosomes or not, if the user inputs 'y' it will animate the target chromosomes. and if they press n it will skip the animation. and progress to step 3. if animation is chosen the animation will iterate from pose A to pose B and back to pose A for 3 cycles. The function also returns maxGenerations, populationSize and mutationRate variables that are used in the genetic algorithm, as the user is required to input data for these variables.

### run_genetic_algorithm(maxGenerations, populationSize, mutationRate, GATargetPoses)
When the user inputs the required data, the main program will progress to running the genetic algorithm function called run_genetic_algorithm(GATargetPoses, maxGenerations, populationSize, mutationRate). This function takes in the target poses and the user-inputted parameters and runs the genetic algorithm to generate a walking gait for the spider robot. it returns a variable called bestChromosome which is the best solution found by the genetic algorithm.

### display_animating_ga_generated_poses(GAPose)
display_animating_ga_generated_poses(GAPose) is the next helper function that is run in the main and prints out step 4 and runs animateTagetChromosomes(GAPose, delay) and returns animateTargetChromosomes function.

### generate_random_pose
generate_random_pose counts the number of poses generated by the genetic algorithm, from here it will print out text that specifies how many random input poses have been generated for the neural network training. It will then create a variable called inputData that is returned from genRandomPoses with the population size set to the number of poses generated by the genetic algorithm.


### train_custom_nn(inputData, GAPoses)
This section will progress to training the custom neural network. to start off the section step 5 within the helper function of train_custom_nn(inputData, GAPoses). 

In this function it fistly prints out the text for step 5 and then creates a variable nn that stores the full neural network as Full_NN(x (input layer size), h (hidden layer size), y (output layer size)). the input layer size is set to 24, hidden layer size is set to [512, 256] and output layer size is set to 24.

within the same helper function it declares nn.train_nn(x = inputData, target = GAPoses, epochs = 1000, lr = 0.01) this is where the neural netwrok is trained with the input data and target data from the genetic algorithm poses as the target data. the epochs is how many times the neural netwrok will iterate over the traing data. lr is the learning rate it determins how much to change the model in response to the estimated error each time the model weights are updated.

### display_custom_nn_input
display_custom_nn_input prints out step 6 and creates a variable called test pose with the genRanPose funtion with a population size of 1. it generates a random test pose, displays it visually, and then returns the pose.

### display_custom_nn_output
display_custom_nn_output(testPose, nn, GATargetPoses) is the next helper function that is run in the main program. it prints out step 7 and runs a test pose through the custom neural network (nn) to get a predicted output pose,this displays the predicted pose visually, and then return the result.

### display_training_pytorch_nn
display_training_pytorch_nn(inputData, GAPoses) is step 8 in the main program imported from the helpers file. iy prints and runs the run_pytorch_nn function that trains a PYTorch neural network and returns the trained model as an output.

### display_pytorch_nn_input()
display_pytorch_nn_input() is step 9 in the main program imported from the helpers file. this function displays the pytorch neural netweok input and testPose2 variable is created from genRanPoses with a population size of 1. this will generate a random test pose. and opens a visual display of the test pose as well as returning testpose2.

### display_pytorch_nn_output
display_pytorch_nn_output(testPose2, pytorch_model, GATargetPoses) is the final step 10 in the main program imported from the helpers file. this function takes in the test pose, the trained pytorch model, and the target poses from the genetic algorithm. it runs the test pose through the pytorch neural network to get a predicted output pose, displays the predicted pose visually, and then returns the result.

### display_all_steps_complete
the final helper function is called display_all_steps_complete, which sprints out all steps complete into the main.

## genetic_algorithm.py
### GA details go here


## nn_self.py
### nn_self.py details go here


## nn_self.py
### nn_self.py details go here


## nn_pytorch.py
### nn_pytorch.py details go here


## forward_leg_kinematics.py
### forward_leg_kinematics details go here


## spider_pose.py
### spider_pose.py details go here

## helpers.py
### helpers.py details go here 

```
Spider/
├── main.py 
├── genetic_algorithm.py             # GA implementation for pose generation
├── nn_self.py                       # Custom neural network from scratch - based on AI Practical 5
├── nn_pytorch.py                    # PyTorch neural network implementation
├── forward_leg_kinematics.py        # 3D forward kinematics for spider legs
├── spider_pose.py                   # 3D visualization of spider poses
├── helpers.py                       # Helper functions for display and user interaction
└── README.md                        # This file
```



## Usage

### Run the Full Pipeline

```bash
python main.py
```

This will execute the following steps:

1. **Display Target Chromosomes**: Shows the two key poses (standing and mid-walk).
2. **Run Genetic Algorithm**: Prompts the user for parameters (generations, population size, mutation rate), then evolves poses to match targets.
3. **Animate GA Poses**: Displays the GA-generated walk cycle.
4. **Train Custom Neural Network**: Trains the from-scratch implementation (`nn_self.py`).
5. **Display Custom NN Output**: Shows the network's prediction compared to the target.
6. **Train PyTorch Neural Network**: Trains the PyTorch implementation (`nn_pytorch.py`).
7. **Display PyTorch NN Output**: Shows the network's prediction compared to the target.

## Credits

- **Forward kinematics (`forward_leg_kinematics.py`) and plotting functions (`spider_pose.py`)**: Originally provided in MATLAB, translated to Python using Gemini 2.5 Pro.
- **Custom neural network (`nn_self.py`)**: Based on code from AI Practical 5.
- **GitHub Copilot**: Used for syntax help and code autocomplete throughout development.

## Repository

https://github.com/AICourseworkGroup/Spider

## Assignment Related Documentation

https://portdotacdotuk-my.sharepoint.com/:w:/g/personal/up2114856_myport_ac_uk/IQAAS21bX1x4QodRN3o5yKCYAUuzCUWxn4VL7oowhPOyW0M?e=4nroir